version: 2

models:
  - name: customers
    columns:
      - name: id
        description: Test doc
        tests:
          - unique
      - name: name
        description: "{{ doc('customers_name') }}"

  - name: items
    description: "{{ doc('items') }}"
    tests:
    - dbt_utils.unique_combination_of_columns:
        combination_of_columns:
          - order_id
          - sku
    columns:
      - name: id
        description: "{{ doc('items_id') }}"
      - name: order_id
        description: "{{ doc('items_order_id') }}"
      - name: sku
        description: "{{ doc('items_sku') }}"

  - name: orders
    description: "{{ doc('orders') }}"
    columns:
      - name: id
        description: "{{ doc('orders_id') }}"
        tests:
          - unique
          - not_null
      - name: customer
        description: "{{ doc('orders_customer') }}"
      - name: ordered_at
        description: "{{ doc('orders_ordered_at') }}"
      - name: store_id
        description: "{{ doc('orders_store_id') }}"
      - name: subtotal
        description: "{{ doc('orders_subtotal') }}"
      - name: tax_paid
        description: "{{ doc('orders_tax_paid') }}"
      - name: order_total
        description: "{{ doc('orders_order_total') }}"

  - name: products
    description: "{{ doc('products') }}"
    columns:
      - name: sku
        description: "{{ doc('products_sku') }}"
        tests:
          - unique
          - not_null
      - name: name
        description: "{{ doc('products_name') }}"
      - name: type
        description: "{{ doc('products_type') }}"
      - name: price
        description: "{{ doc('products_price') }}"
      - name: description
        description: "{{ doc('products_description') }}"

  - name: stores
    description: "{{ doc('stores') }}"
    columns:
      - name: id
        description: "{{ doc('stores_id') }}"
        tests:
          - unique
          - not_null
      - name: name
        description: "{{ doc('stores_name') }}"
      - name: opened_at
        description: "{{ doc('stores_opened_at') }}"
      - name: tax_rate
        description: "{{ doc('stores_tax_rate') }}"

  - name: supplies
    description: "{{ doc('supplies') }}"
    tests:
    - dbt_utils.unique_combination_of_columns:
        combination_of_columns:
          - id
          - sku
    columns:
      - name: id
        description: "{{ doc('supplies_id') }}"
      - name: name
        description: "{{ doc('supplies_name') }}"
      - name: cost
        description: "{{ doc('supplies_cost') }}"
      - name: perishable
        description: "{{ doc('supplies_perishable') }}"
      - name: sku
        description: "{{ doc('supplies_sku') }}"
